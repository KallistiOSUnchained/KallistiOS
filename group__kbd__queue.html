<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KallistiOS: Queue Monitoring</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">KallistiOS<span id="projectnumber">&#160;git master</span>
   </div>
   <div id="projectbrief">Independent SDK for the Sega Dreamcast</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__kbd__queue.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Queue Monitoring<div class="ingroups"><a class="el" href="group__peripherals.html">Peripherals</a> &raquo; <a class="el" href="group__kbd.html">Keyboard</a> &raquo; <a class="el" href="group__kbd__input.html">Querying for Input</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Monitor queue for key press events.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gaf8a95f173e93b8af6091a7b915d7d5be" id="r_gaf8a95f173e93b8af6091a7b915d7d5be"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf8a95f173e93b8af6091a7b915d7d5be">KBD_QUEUE_SIZE</a>&#160;&#160;&#160;16</td></tr>
<tr class="memdesc:gaf8a95f173e93b8af6091a7b915d7d5be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of a keyboard queue.  <br /></td></tr>
<tr class="separator:gaf8a95f173e93b8af6091a7b915d7d5be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa115d28788304a16204392b89ceae321" id="r_gaa115d28788304a16204392b89ceae321"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa115d28788304a16204392b89ceae321">KBD_QUEUE_END</a>&#160;&#160;&#160;-1</td></tr>
<tr class="memdesc:gaa115d28788304a16204392b89ceae321"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delimiter value for <a class="el" href="#ga60207c54ce956c976961ab2c7a67884b" title="Pop a key off a specific keyboard&#39;s queue.">kbd_queue_pop()</a>  <br /></td></tr>
<tr class="separator:gaa115d28788304a16204392b89ceae321"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga10307c972c3fb42f39a16035a22539eb" id="r_ga10307c972c3fb42f39a16035a22539eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga10307c972c3fb42f39a16035a22539eb">kbd_set_repeat_timing</a> (uint16_t start, uint16_t interval)</td></tr>
<tr class="memdesc:ga10307c972c3fb42f39a16035a22539eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures held key auto-repeat intervals.  <br /></td></tr>
<tr class="separator:ga10307c972c3fb42f39a16035a22539eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga60207c54ce956c976961ab2c7a67884b" id="r_ga60207c54ce956c976961ab2c7a67884b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga60207c54ce956c976961ab2c7a67884b">kbd_queue_pop</a> (<a class="el" href="structmaple__device__t.html">maple_device_t</a> *dev, bool xlat)</td></tr>
<tr class="memdesc:ga60207c54ce956c976961ab2c7a67884b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pop a key off a specific keyboard's queue.  <br /></td></tr>
<tr class="separator:ga60207c54ce956c976961ab2c7a67884b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga92be71208168ee6163b3793e29d70ac4" id="r_ga92be71208168ee6163b3793e29d70ac4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga92be71208168ee6163b3793e29d70ac4">kbd_set_queue</a> (int active) <a class="el" href="group__system__macros.html#ga4e1585cb1b8a465a6a9a702d97bb4ad8">__deprecated</a></td></tr>
<tr class="memdesc:ga92be71208168ee6163b3793e29d70ac4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Activate or deactivate global key queueing.  <br /></td></tr>
<tr class="separator:ga92be71208168ee6163b3793e29d70ac4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga624304aea04506a26d96e5d885feff8d" id="r_ga624304aea04506a26d96e5d885feff8d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga624304aea04506a26d96e5d885feff8d">kbd_get_key</a> (void) <a class="el" href="group__system__macros.html#ga4e1585cb1b8a465a6a9a702d97bb4ad8">__deprecated</a></td></tr>
<tr class="memdesc:ga624304aea04506a26d96e5d885feff8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pop a key off the global keyboard queue.  <br /></td></tr>
<tr class="separator:ga624304aea04506a26d96e5d885feff8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Monitor queue for key press events. </p>
<dl class="section user"><dt>Popping from the Queue</dt><dd>One method of checking for key input is to use the internal key press queue. This is most frequently used when keyboard input is used within a text processing context, which is only concerned with individual key press events, rather than the frame-by-frame state.</dd></dl>
<dl class="section user"><dt></dt><dd>We simply pop keys off of the queue in a loop, until the queue is empty: <pre class="fragment">int k;

while((k = kbd_queue_pop(device, 1)) != KBD_QUEUE_END)
    printf("Key pressed: %c!\n", (char)k);
</pre> </dd></dl>
<dl class="section user"><dt>Repeated Presses</dt><dd>As with a text processor, a key which has been held down for a duration of time will generate periodic key press events which will be pushed onto the queue. </dd></dl>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gaa115d28788304a16204392b89ceae321" name="gaa115d28788304a16204392b89ceae321"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa115d28788304a16204392b89ceae321">&#9670;&#160;</a></span>KBD_QUEUE_END</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KBD_QUEUE_END&#160;&#160;&#160;-1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delimiter value for <a class="el" href="#ga60207c54ce956c976961ab2c7a67884b" title="Pop a key off a specific keyboard&#39;s queue.">kbd_queue_pop()</a> </p>
<p>Value returned from <a class="el" href="#ga60207c54ce956c976961ab2c7a67884b" title="Pop a key off a specific keyboard&#39;s queue.">kbd_queue_pop()</a> when there are no more keys in the queue.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga60207c54ce956c976961ab2c7a67884b" title="Pop a key off a specific keyboard&#39;s queue.">kbd_queue_pop()</a> </dd></dl>

</div>
</div>
<a id="gaf8a95f173e93b8af6091a7b915d7d5be" name="gaf8a95f173e93b8af6091a7b915d7d5be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf8a95f173e93b8af6091a7b915d7d5be">&#9670;&#160;</a></span>KBD_QUEUE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KBD_QUEUE_SIZE&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of a keyboard queue. </p>
<p>Each keyboard queue will hold this many elements. Once the queue fills, no new elements will be placed on the queue. As long as you check the queue relatively frequently, the default of 16 should be plenty.</p>
<dl class="section note"><dt>Note</dt><dd>This <b>MUST</b> be a power of two. </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga624304aea04506a26d96e5d885feff8d" name="ga624304aea04506a26d96e5d885feff8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga624304aea04506a26d96e5d885feff8d">&#9670;&#160;</a></span>kbd_get_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kbd_get_key </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pop a key off the global keyboard queue. </p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000027">Deprecated</a></b></dt><dd></dd></dl>
<p>This function pops the front off of the keyboard queue, and returns the value to the caller. The value returned will be the ASCII value of the key pressed (accounting for the shift keys being pressed).</p>
<p>If a key does not have an ASCII value associated with it, the raw key code will be returned, shifted up by 8 bits.</p>
<dl class="section return"><dt>Returns</dt><dd>The value at the front of the queue, or KBD_QUEUE_END if there are no keys in the queue or queueing is off. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function does not account for non-US keyboard layouts properly (for compatibility with old code), and is deprecated. Use the individual keyboard queues instead to properly account for non-US keyboards. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga60207c54ce956c976961ab2c7a67884b" title="Pop a key off a specific keyboard&#39;s queue.">kbd_queue_pop()</a> </dd></dl>

</div>
</div>
<a id="ga60207c54ce956c976961ab2c7a67884b" name="ga60207c54ce956c976961ab2c7a67884b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga60207c54ce956c976961ab2c7a67884b">&#9670;&#160;</a></span>kbd_queue_pop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kbd_queue_pop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmaple__device__t.html">maple_device_t</a> *</td>          <td class="paramname"><span class="paramname"><em>dev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>xlat</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pop a key off a specific keyboard's queue. </p>
<p>This function pops the front element off of the specified keyboard queue, and returns the value of that key to the caller.</p>
<p>If the <code>xlat</code> parameter is true and the key represents an ISO-8859-1 character, that is the value that will be returned from this function. If the key cannot be converted into a valid ISO-8859-1 character the raw key code, shifted up by 8 bits, will be returned.</p>
<p>If the <code>xlat</code> parameter is false, the lower 8 bits of the returned value will be the raw key code. The next 8 bits will be the modifier keys that were down when the key was pressed (<a class="el" href="unionkbd__mods__t.html" title="Modifier Keys.">kbd_mods_t</a>). The next 8 bits will be the lock key/LED statuses (<a class="el" href="unionkbd__leds__t.html" title="Keyboard LEDs.">kbd_leds_t</a>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>The keyboard device to read from. </td></tr>
    <tr><td class="paramname">xlat</td><td>Set to true to do key translation. Otherwise, you'll simply get the raw key value. Raw key values are not mapped at all, so you are responsible for figuring out what it is by the region.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The value at the front of the queue, or KBD_QUEUE_END if there are no keys in the queue. </dd></dl>

</div>
</div>
<a id="ga92be71208168ee6163b3793e29d70ac4" name="ga92be71208168ee6163b3793e29d70ac4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga92be71208168ee6163b3793e29d70ac4">&#9670;&#160;</a></span>kbd_set_queue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kbd_set_queue </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>active</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Activate or deactivate global key queueing. </p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000026">Deprecated</a></b></dt><dd></dd></dl>
<p>This function will turn the internal keyboard queueing on or off. Note that there is only one queue for the whole system, no matter how many keyboards are attached, and the queue is of fairly limited length. Turning queueing off is useful (for instance) in a game where individual keypresses don't mean as much as having the keys up or down does.</p>
<p>You can clear the queue (without popping all the keys off) by setting the active value to a different value than it was.</p>
<p>The queue is by default on, unless you turn it off.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">active</td><td>Set to non-zero to activate the queue. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The global queue does not account for non-US keyboard layouts and is deprecated. Please use the individual queues instead for future code. </dd></dl>

</div>
</div>
<a id="ga10307c972c3fb42f39a16035a22539eb" name="ga10307c972c3fb42f39a16035a22539eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga10307c972c3fb42f39a16035a22539eb">&#9670;&#160;</a></span>kbd_set_repeat_timing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kbd_set_repeat_timing </td>
          <td>(</td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>start</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>interval</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configures held key auto-repeat intervals. </p>
<p>This function is used to configure the specific timing behavior for how the internal queue treats a key which is being held down. Giving non-zero values for both parameters will cause the held key to be re-enqueued every <code>interval</code> milliseconds after it has been held for the initial <code>start</code> time in milliseconds.</p>
<p>Specifying a value of zero for the two parameters disables this repeating key behavior.</p>
<dl class="section note"><dt>Note</dt><dd>By default, the <code>start</code> time is 600ms while the repeating <code>interval</code> is 20ms.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start</td><td>The duration after which the held key starts to register as repeated key presses (or zero to disable this behavior). </td></tr>
    <tr><td class="paramname">interval</td><td>The duration between subsequent key repeats after the initial <code>start</code> time has elapsed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga60207c54ce956c976961ab2c7a67884b" title="Pop a key off a specific keyboard&#39;s queue.">kbd_queue_pop()</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
