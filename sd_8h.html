<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KallistiOS: kernel/arch/dreamcast/include/dc/sd.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">KallistiOS<span id="projectnumber">&#160;git master</span>
   </div>
   <div id="projectbrief">Independent SDK for the Sega Dreamcast</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('sd_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">sd.h File Reference<div class="ingroups"><a class="el" href="group__vfs.html">Filesystem</a> &raquo; <a class="el" href="group__vfs__sd.html">SD Card</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Block-level access to an SD card attached to the SCI or SCIF port.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;sys/cdefs.h&gt;</code><br />
<code>#include &lt;<a class="el" href="types_8h_source.html">arch/types.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="blockdev_8h_source.html">kos/blockdev.h</a>&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
</div>
<p><a href="sd_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsd__init__params__t.html">sd_init_params_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SD card initialization parameters.  <a href="structsd__init__params__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gaef5079cbc7014c332608bbf442ed8aa9" id="r_gaef5079cbc7014c332608bbf442ed8aa9"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vfs__sd.html#gaef5079cbc7014c332608bbf442ed8aa9">sd_interface_t</a> { <a class="el" href="group__vfs__sd.html#ggaef5079cbc7014c332608bbf442ed8aa9a755986065fb55f7f9f97fa1361f3370a">SD_IF_SCIF</a> = 0
, <a class="el" href="group__vfs__sd.html#ggaef5079cbc7014c332608bbf442ed8aa9afcc317684fb9fc35b02625e3e3b85ca1">SD_IF_SCI</a> = 1
 }</td></tr>
<tr class="memdesc:gaef5079cbc7014c332608bbf442ed8aa9"><td class="mdescLeft">&#160;</td><td class="mdescRight">SD card interface type.  <a href="group__vfs__sd.html#gaef5079cbc7014c332608bbf442ed8aa9">More...</a><br /></td></tr>
<tr class="separator:gaef5079cbc7014c332608bbf442ed8aa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga702d73eee91009fc60a68f5cdf5332df" id="r_ga702d73eee91009fc60a68f5cdf5332df"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__system__types.html#gadde6aaee8457bee49c2a92621fe22b79">uint8</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vfs__sd.html#ga702d73eee91009fc60a68f5cdf5332df">sd_crc7</a> (const <a class="el" href="group__system__types.html#gadde6aaee8457bee49c2a92621fe22b79">uint8</a> *data, int size, <a class="el" href="group__system__types.html#gadde6aaee8457bee49c2a92621fe22b79">uint8</a> crc)</td></tr>
<tr class="memdesc:ga702d73eee91009fc60a68f5cdf5332df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate a SD/MMC-style CRC over a block of data.  <br /></td></tr>
<tr class="separator:ga702d73eee91009fc60a68f5cdf5332df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8228bbbb1e7fa40052bbf9bdfb9672b5" id="r_ga8228bbbb1e7fa40052bbf9bdfb9672b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vfs__sd.html#ga8228bbbb1e7fa40052bbf9bdfb9672b5">sd_init_ex</a> (const <a class="el" href="structsd__init__params__t.html">sd_init_params_t</a> *params)</td></tr>
<tr class="memdesc:ga8228bbbb1e7fa40052bbf9bdfb9672b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the SD card with extended parameters.  <br /></td></tr>
<tr class="separator:ga8228bbbb1e7fa40052bbf9bdfb9672b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga51531c835e2323129f557b6086f4d7bd" id="r_ga51531c835e2323129f557b6086f4d7bd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vfs__sd.html#ga51531c835e2323129f557b6086f4d7bd">sd_init</a> (void)</td></tr>
<tr class="memdesc:ga51531c835e2323129f557b6086f4d7bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the SD card for use.  <br /></td></tr>
<tr class="separator:ga51531c835e2323129f557b6086f4d7bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9757bfb5f1010c3d53fbf116c233f7f1" id="r_ga9757bfb5f1010c3d53fbf116c233f7f1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vfs__sd.html#ga9757bfb5f1010c3d53fbf116c233f7f1">sd_shutdown</a> (void)</td></tr>
<tr class="memdesc:ga9757bfb5f1010c3d53fbf116c233f7f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shut down SD card support.  <br /></td></tr>
<tr class="separator:ga9757bfb5f1010c3d53fbf116c233f7f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89e03b88dd86d19352e62a6794ff423b" id="r_ga89e03b88dd86d19352e62a6794ff423b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vfs__sd.html#ga89e03b88dd86d19352e62a6794ff423b">sd_read_blocks</a> (<a class="el" href="group__system__types.html#ga4b435a49c74bb91f284f075e63416cb6">uint32</a> block, size_t count, <a class="el" href="group__system__types.html#gadde6aaee8457bee49c2a92621fe22b79">uint8</a> *buf)</td></tr>
<tr class="memdesc:ga89e03b88dd86d19352e62a6794ff423b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read one or more blocks from the SD card.  <br /></td></tr>
<tr class="separator:ga89e03b88dd86d19352e62a6794ff423b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0bfb1cd45947d5f16707a231e2f1bb05" id="r_ga0bfb1cd45947d5f16707a231e2f1bb05"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vfs__sd.html#ga0bfb1cd45947d5f16707a231e2f1bb05">sd_write_blocks</a> (<a class="el" href="group__system__types.html#ga4b435a49c74bb91f284f075e63416cb6">uint32</a> block, size_t count, const <a class="el" href="group__system__types.html#gadde6aaee8457bee49c2a92621fe22b79">uint8</a> *buf)</td></tr>
<tr class="memdesc:ga0bfb1cd45947d5f16707a231e2f1bb05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write one or more blocks to the SD card.  <br /></td></tr>
<tr class="separator:ga0bfb1cd45947d5f16707a231e2f1bb05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga455fe9cb80944537f2b8b4572f75a718" id="r_ga455fe9cb80944537f2b8b4572f75a718"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__system__types.html#ga29940ae63ec06c9998bba873e25407ad">uint64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vfs__sd.html#ga455fe9cb80944537f2b8b4572f75a718">sd_get_size</a> (void)</td></tr>
<tr class="memdesc:ga455fe9cb80944537f2b8b4572f75a718"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the size of the SD card.  <br /></td></tr>
<tr class="separator:ga455fe9cb80944537f2b8b4572f75a718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae4d6b3902d95916b8c6e295984c590c8" id="r_gae4d6b3902d95916b8c6e295984c590c8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vfs__sd.html#gae4d6b3902d95916b8c6e295984c590c8">sd_blockdev_for_partition</a> (int partition, <a class="el" href="structkos__blockdev__t.html">kos_blockdev_t</a> *rv, <a class="el" href="group__system__types.html#gadde6aaee8457bee49c2a92621fe22b79">uint8</a> *partition_type)</td></tr>
<tr class="memdesc:gae4d6b3902d95916b8c6e295984c590c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a block device for a given partition on the SD card.  <br /></td></tr>
<tr class="separator:gae4d6b3902d95916b8c6e295984c590c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4a87832e0886abc3a871a7e9708cab4a" id="r_ga4a87832e0886abc3a871a7e9708cab4a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vfs__sd.html#ga4a87832e0886abc3a871a7e9708cab4a">sd_blockdev_for_device</a> (<a class="el" href="structkos__blockdev__t.html">kos_blockdev_t</a> *rv)</td></tr>
<tr class="memdesc:ga4a87832e0886abc3a871a7e9708cab4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a block device for the SD card.  <br /></td></tr>
<tr class="separator:ga4a87832e0886abc3a871a7e9708cab4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Block-level access to an SD card attached to the SCI or SCIF port. </p>
<p>This file contains the interface to working with SD card readers. The original SD card reader designed by jj1odm connects to the SCIF port, while the SCI port implementation was developed by SWAT (Ruslan Rostovtsev). The SCIF implementation uses bit-banging technique to emulate SPI protocol, while the SCI implementation utilizes the synchronous mode of this interface, which is very similar to SPI.</p>
<p>For reference, all I/O through this code should be done in the order of SD card blocks (which are 512 bytes a piece). Also, this should adequately support SD and SDHC cards (and possibly SDXC, but I don't have any of them to try out).</p>
<p>This code doesn't directly implement any filesystems on top of the SD card, but rather provides you with direct block-level access. This probably will not be useful to most people in its current form (without a filesystem), but this will provide you with all of the building blocks you should need to actually make it work for you.</p>
<p>Due to the patent-encumbered nature of certain parts of the FAT32 filesystem, that filesystem will likely never be supported in KOS proper (unless, of course, people are still using KOS after those patents expire). I'm not going to encourage anyone to violate Microsoft's patents on FAT32 and I'm not going to be the enabler for anyone to do so either. So, if you want FAT32, you're on your own.</p>
<dl class="section author"><dt>Author</dt><dd>Lawrence Sebald </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="scif_8h.html" title="Serial port functionality.">dc/scif.h</a> </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_4a04b9aac4eefdd334a78e565f4616f2.html">arch</a></li><li class="navelem"><a class="el" href="dir_49fbd9c46ac73fe76d8a6b686de400da.html">dreamcast</a></li><li class="navelem"><a class="el" href="dir_08ece2ffab5ad20e41852b4cf81b30e2.html">include</a></li><li class="navelem"><a class="el" href="dir_39421b6c340728d4b73811bee3577133.html">dc</a></li><li class="navelem"><a class="el" href="sd_8h.html">sd.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
